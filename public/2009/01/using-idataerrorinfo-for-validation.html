<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Using IDataErrorInfo for Validation | Hugo Quick Start Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I read an article on CodeProject titled Total View Validation where the author complains that IDataErrorInfo is inadequate for WPF validation. The assumption he makes is that all the validation code needs to go into the IDataErrorInfo.this[string] property as such:
public string this[string name] { get { string result = null; if (name == &#34;Age&#34;) if (this.age &lt; 0 || this.age &gt; 150) result = &#34;Age must not be less than 0 or greater than 150.">
    <meta name="generator" content="Hugo 0.121.2">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="https://example.org/2009/01/using-idataerrorinfo-for-validation.html">
    

    <meta property="og:title" content="Using IDataErrorInfo for Validation" />
<meta property="og:description" content="I read an article on CodeProject titled Total View Validation where the author complains that IDataErrorInfo is inadequate for WPF validation. The assumption he makes is that all the validation code needs to go into the IDataErrorInfo.this[string] property as such:
public string this[string name] { get { string result = null; if (name == &#34;Age&#34;) if (this.age &lt; 0 || this.age &gt; 150) result = &#34;Age must not be less than 0 or greater than 150." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/2009/01/using-idataerrorinfo-for-validation.html" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2009-01-28T10:10:00-08:00" />
<meta property="article:modified_time" content="2009-01-28T10:10:00-08:00" />

<meta itemprop="name" content="Using IDataErrorInfo for Validation">
<meta itemprop="description" content="I read an article on CodeProject titled Total View Validation where the author complains that IDataErrorInfo is inadequate for WPF validation. The assumption he makes is that all the validation code needs to go into the IDataErrorInfo.this[string] property as such:
public string this[string name] { get { string result = null; if (name == &#34;Age&#34;) if (this.age &lt; 0 || this.age &gt; 150) result = &#34;Age must not be less than 0 or greater than 150."><meta itemprop="datePublished" content="2009-01-28T10:10:00-08:00" />
<meta itemprop="dateModified" content="2009-01-28T10:10:00-08:00" />
<meta itemprop="wordCount" content="355">
<meta itemprop="keywords" content=".Net,Rant," /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Using IDataErrorInfo for Validation"/>
<meta name="twitter:description" content="I read an article on CodeProject titled Total View Validation where the author complains that IDataErrorInfo is inadequate for WPF validation. The assumption he makes is that all the validation code needs to go into the IDataErrorInfo.this[string] property as such:
public string this[string name] { get { string result = null; if (name == &#34;Age&#34;) if (this.age &lt; 0 || this.age &gt; 150) result = &#34;Age must not be less than 0 or greater than 150."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Hugo Quick Start Site
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Using IDataErrorInfo for Validation</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2009-01-28T10:10:00-08:00">January 28, 2009</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I read an article on <a href="http://www.codeproject.com">CodeProject</a> titled <a href="http://www.codeproject.com/KB/WPF/GlobalWPFValidation.aspx">Total View Validation</a> where the author complains that IDataErrorInfo is inadequate for WPF validation.  The assumption he makes is that all the validation code needs to go into the IDataErrorInfo.this[string] property as such:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">this</span>[<span style="color:#66d9ef">string</span> name]  
</span></span><span style="display:flex;"><span>{  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span>  
</span></span><span style="display:flex;"><span>    {  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> result = <span style="color:#66d9ef">null</span>;  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name == <span style="color:#e6db74">&#34;Age&#34;</span>)  
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.age &lt; <span style="color:#ae81ff">0</span> || <span style="color:#66d9ef">this</span>.age &gt; <span style="color:#ae81ff">150</span>)  
</span></span><span style="display:flex;"><span>                result = <span style="color:#e6db74">&#34;Age must not be less than 0 or greater than 150.&#34;</span>;  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;  
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span>}  
</span></span></code></pre></div><p>This should not be the way that IDataErrorInfo is used as it puts business logic in the model, as the author points out. His solution though was to create another mechanism to notifiy the user of validation errors and to not use IDataErrorInfo at all.</p>
<p>A solution I would propose though would be to follow how DataTables and DataTables use IDataErrorInfo by implementing methods to set and clear the objects error information:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SomeClass</span> : IDataErrorInfo
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Name { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Age { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#region</span> Data Error Info  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt; _propertyErrors;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> InitDataErrorInfo()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> properties = <span style="color:#66d9ef">this</span>.GetType().GetProperties();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// This will act as an overall error message for the entire object.  </span>
</span></span><span style="display:flex;"><span>        _propertyErrors = <span style="color:#66d9ef">new</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            {<span style="color:#66d9ef">this</span>.GetHashCode().ToString(CultureInfo.InvariantCulture), <span style="color:#66d9ef">string</span>.Empty}
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> propertyInfo <span style="color:#66d9ef">in</span> properties)
</span></span><span style="display:flex;"><span>            _propertyErrors.Add(propertyInfo.Name, <span style="color:#66d9ef">string</span>.Empty);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ClearDataErrorInfo()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> property <span style="color:#66d9ef">in</span> _propertyErrors.Keys)
</span></span><span style="display:flex;"><span>            _propertyErrors[property] = <span style="color:#66d9ef">string</span>.Empty;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ClearDataErrorInfo(<span style="color:#66d9ef">string</span> propertyName)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        AssertThisHasPropertyWithName(propertyName);
</span></span><span style="display:flex;"><span>        _propertyErrors[propertyName] = <span style="color:#66d9ef">string</span>.Empty;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SetError(<span style="color:#66d9ef">string</span> error)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        SetError(<span style="color:#66d9ef">this</span>.GetHashCode().ToString(CultureInfo.InvariantCulture), error);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SetError(<span style="color:#66d9ef">string</span> propertyName, <span style="color:#66d9ef">string</span> error)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        AssertThisHasPropertyWithName(propertyName);
</span></span><span style="display:flex;"><span>        _propertyErrors[propertyName] = <span style="color:#66d9ef">string</span>.Format(<span style="color:#e6db74">&#34;{0}{1}{2}&#34;</span>, _propertyErrors[propertyName]
</span></span><span style="display:flex;"><span>        , Environment.NewLine, error);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">this</span>[<span style="color:#66d9ef">string</span> propertyName]
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            AssertThisHasPropertyWithName(propertyName);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> _propertyErrors[propertyName];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Error
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> errors = <span style="color:#66d9ef">new</span> StringBuilder();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">foreach</span> (
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> propertyError <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>            _propertyErrors.Where(propertyError =&gt; !<span style="color:#66d9ef">string</span>.IsNullOrEmpty(propertyError.Value)))
</span></span><span style="display:flex;"><span>                errors.AppendLine(propertyError.Value);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> errors.ToString().Trim();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> AssertThisHasPropertyWithName(<span style="color:#66d9ef">string</span> propertyName)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (!_propertyErrors.ContainsKey(propertyName))
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> ArgumentException(<span style="color:#66d9ef">string</span>.Format(<span style="color:#e6db74">&#34;No property named {0} on {1}.&#34;</span>
</span></span><span style="display:flex;"><span>            , propertyName, <span style="color:#66d9ef">this</span>.GetType().FullName));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#endregion</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Note that there is no validation here, only reporting if the object has errors. Using this takes advantage of the already existing validation notification built into WPF as well as WinForms.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/.net/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">.Net</a>
   </li>
  
   <li class="list di">
     <a href="/tags/rant/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Rant</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/2008/02/datasets-love-em-hate-em.html">DataSets - Love em Hate em</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/what-in-name.html">What&amp;#39;s in a Name?</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/06/resharper-vs-coderush.html">Resharper vs CodeRush</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2005/08/if-we-got-this-far-then-everything-is.html">if we got this far, then everything is working properly</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2008/05/changing-typed-dataset-connection-string.html">Changing Typed DataSet Connection String</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/10/crappy-apps.html">Crappy Apps</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/06/chevy-vega-vs-testdrivennet.html">Chevy Vega vs. TestDriven.Net</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/03/learning-typemocknet.html">Learning TypeMock.Net</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/01/david-hayden-mvp-c-validation.html">David Hayden [MVP C#] : Validation Application Block - Integrating It Into Your Business Layer</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/12/comments-for-code-review.html">Comments for a Code Review</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/mad-world.html">Mad World</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/switched-back-to-resharper.html">Switched Back to ReSharper</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/say-what.html">Say What?</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/09/cisco-vpn-sucks.html">Cisco VPN Sucks</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/09/outlook-rules-blackberry-sucks.html">Outlook Rules &#43; Blackberry == SUCKS</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://example.org/" >
    &copy;  Hugo Quick Start Site 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
