<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Changing Typed DataSet Connection String | Hugo Quick Start Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I was working on a WinForm app that connected to a MS Access database. Yeah, Access sucks but I didn&rsquo;t have a choice in the matter.
The app itself is used to import a bunch of CSV files into the Access database. It is more of a utility program and it has going through several variations, from being a simple hand driven command line tool to being GUI driven.
The command line version was all hand controlled.">
    <meta name="generator" content="Hugo 0.121.2">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="https://example.org/2008/05/changing-typed-dataset-connection-string.html">
    

    <meta property="og:title" content="Changing Typed DataSet Connection String" />
<meta property="og:description" content="I was working on a WinForm app that connected to a MS Access database. Yeah, Access sucks but I didn&rsquo;t have a choice in the matter.
The app itself is used to import a bunch of CSV files into the Access database. It is more of a utility program and it has going through several variations, from being a simple hand driven command line tool to being GUI driven.
The command line version was all hand controlled." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/2008/05/changing-typed-dataset-connection-string.html" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2008-05-13T13:26:00-07:00" />
<meta property="article:modified_time" content="2008-05-13T13:26:00-07:00" />

<meta itemprop="name" content="Changing Typed DataSet Connection String">
<meta itemprop="description" content="I was working on a WinForm app that connected to a MS Access database. Yeah, Access sucks but I didn&rsquo;t have a choice in the matter.
The app itself is used to import a bunch of CSV files into the Access database. It is more of a utility program and it has going through several variations, from being a simple hand driven command line tool to being GUI driven.
The command line version was all hand controlled."><meta itemprop="datePublished" content="2008-05-13T13:26:00-07:00" />
<meta itemprop="dateModified" content="2008-05-13T13:26:00-07:00" />
<meta itemprop="wordCount" content="678">
<meta itemprop="keywords" content=".Net," /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Changing Typed DataSet Connection String"/>
<meta name="twitter:description" content="I was working on a WinForm app that connected to a MS Access database. Yeah, Access sucks but I didn&rsquo;t have a choice in the matter.
The app itself is used to import a bunch of CSV files into the Access database. It is more of a utility program and it has going through several variations, from being a simple hand driven command line tool to being GUI driven.
The command line version was all hand controlled."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Hugo Quick Start Site
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Changing Typed DataSet Connection String</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2008-05-13T13:26:00-07:00">May 13, 2008</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I was working on a WinForm app that connected to a MS Access database. Yeah, Access sucks but I didn&rsquo;t have a choice in the matter.</p>
<p>The app itself is used to import a bunch of CSV files into the Access database. It is more of a utility program and it has going through several variations, from being a simple hand driven command line tool to being GUI driven.</p>
<p>The command line version was all hand controlled. I had to go in and update configuration files to point to the CSV files and the MDB database. That got old fast so I decided to make a GUI version that would allow me to pick the MDB file and each of the CSV files to import. Picking and using the CSV files was easy, it was changing the connection string for the MDB that proved to be the hardest.</p>
<p>I am using strongly typed datasets in VS2005. If you have ever worked with them you find out soon that the connection string gets saved with the project in the app.config file, even if it is a separate DAL dll project. My guess is that Microsoft assumed that if you ever had a connection to one database then your strongly typed dataset would not have to change to another database, but if you did you could always just update the configuration file.</p>
<p>As my drill instructor was always fond of saying: &ldquo;Wrong f***ing answer!&rdquo;</p>
<p>I wanted, in the case, to use a strongly typed dataset. I also wanted to use different Access files, and I wanted to be able to select which Access file I used while the application was running. Why is that so hard?</p>
<p>I searched the web and found several not so useful suggestions. It appears that there are two camps of people for this issue: Those that understood what I wanted to do and were trying to do it also, and those that didn&rsquo;t understand what the problem was.</p>
<p>Those in the latter camp always resorted to the same suggestion: Just update the configuration files to point to the new database. This doesn&rsquo;t work in this case because I would then have to restart the app in order for the new setting to be picked up.</p>
<p>The other popular option was to completely re-write the Settings.Designer.cs file so that when the DataTables called to get the connection string it would call a method you created so you could pass anything into it you wanted. The problem with this approach is that if you changed any of the other settings then your code would get over-written by Visual Studio.</p>
<p>The least popular option was to go to each DataTable and create partial classes that override the InitConnection() method. This royally sucks if you have lots of DataTables.</p>
<p>In the Settings class, all Connection String types are application level and cannot be made into User Settings. This leads to the other issue, namely all Connection String settings are read-only. But this is true only for saving the connection string, which is not something I needed to do. I just need to be able to change it.</p>
<p>Also the Settings class is internal and sealed, which means it cannot be accessed from outside of the current project. So my GUI project cannot directly access my DAL project and update the Settings value. To get around that limitation I just created a proxy class. The resulting class is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> DC.Catalog.DAL.Properties;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> DC.Catalog.DAL
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EquipmentConnectionSettings</span>
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> SetEquipmentToConnectToMdb(<span style="color:#66d9ef">string</span> MdbFilename)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                  <span style="color:#75715e">// This only overrides the in-memory copy of the setting. </span>
</span></span><span style="display:flex;"><span>                  <span style="color:#75715e">// It is not permanent.</span>
</span></span><span style="display:flex;"><span>                  Settings.Default[<span style="color:#e6db74">&#34;EquipmentConnectionString&#34;</span>] = <span style="color:#66d9ef">string</span>.Format(
</span></span><span style="display:flex;"><span>                        Settings.Default.EquipmentConnectionStringTemplate
</span></span><span style="display:flex;"><span>                        , MdbFilename);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice that to update the setting value I had to use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Settings.Default[<span style="color:#e6db74">&#34;EquipmentConnectionString&#34;</span>]
</span></span></code></pre></div><p>Since the setting Settings.Default.EquipmentConnectionString is readonly I had to use the other way to access the value. The EquipmentConnectionStringTemplate is simple:</p>
<pre tabindex="0"><code>Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0}  
</code></pre><p>Every time I change the Access file I am pointing at I call the SetEquipmentToConnectToMdb() method, magic happens in the Typed DataSet and it all just works.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/.net/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">.Net</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/2008/02/datasets-love-em-hate-em.html">DataSets - Love em Hate em</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/03/learning-typemocknet.html">Learning TypeMock.Net</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2007/01/david-hayden-mvp-c-validation.html">David Hayden [MVP C#] : Validation Application Block - Integrating It Into Your Business Layer</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/what-in-name.html">What&amp;#39;s in a Name?</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/11/switched-back-to-resharper.html">Switched Back to ReSharper</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/08/building-build-server-with-ccnet.html">Building a build server with CC.NET</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/08/reading-net-configuration-files.html">Reading .NET Configuration Files</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/06/resharper-vs-coderush.html">Resharper vs CodeRush</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2006/02/semi-xp-development.html">Semi-XP Development</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2005/08/rob-caron-blog-team-system-nexus.html">Rob Caron&amp;#39;s Blog - A Team System Nexus : Suggested Reading - 2005-07-31</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2005/08/if-we-got-this-far-then-everything-is.html">if we got this far, then everything is working properly</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2004/12/resources-for-packaging-and-deploying.html">Resources for Packaging and Deploying .NET Compact Framework-based applications</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2004/11/cf-form-disposal.html">CF Form Disposal</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/2004/01/period-matirx-twisting.html">Period Matirx Twisting</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://example.org/" >
    &copy;  Hugo Quick Start Site 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
